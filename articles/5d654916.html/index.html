<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 4.2.1"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css"><script src="/lib/pace/pace.min.js"></script><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"wangng.com",root:"/",scheme:"Pisces",version:"7.7.2",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!1,show_result:!1,style:null},back2top:{enable:!0,sidebar:!0,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!1,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="CNN的缺陷&amp;ensp;&amp;ensp;CNN中，每个卷积核就是一个filter，卷积的操作是在图片中与对应位置相乘后求和，其实就是求相关性，filter就是需要匹配的模板，各种filter具有不同的作用，有的对边缘敏感，有的对颜色敏感。每个神经元包含很多个filter，以用来检测特定的feature。如图1所示，如果神经元检测到图片中包含很多黄色块，神经元就会很敏感。"><meta property="og:type" content="article"><meta property="og:title" content="胶囊神经网络"><meta property="og:url" content="https://wangng.com/articles/5d654916.html/index.html"><meta property="og:site_name" content="jackcywang&#39;s blog"><meta property="og:description" content="CNN的缺陷&amp;ensp;&amp;ensp;CNN中，每个卷积核就是一个filter，卷积的操作是在图片中与对应位置相乘后求和，其实就是求相关性，filter就是需要匹配的模板，各种filter具有不同的作用，有的对边缘敏感，有的对颜色敏感。每个神经元包含很多个filter，以用来检测特定的feature。如图1所示，如果神经元检测到图片中包含很多黄色块，神经元就会很敏感。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://cdn.wangng.com/Deeplearning/%E8%83%B6%E5%9B%8A%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/%E6%A0%A1%E8%BD%A6%E7%A4%BA%E4%BE%8B.png"><meta property="og:image" content="http://cdn.wangng.com/Deeplearning/%E8%83%B6%E5%9B%8A%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/%E6%9B%B2%E7%BA%BF%E7%A4%BA%E4%BE%8B.png"><meta property="og:image" content="http://cdn.wangng.com/Deeplearning/%E8%83%B6%E5%9B%8A%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/%E4%BA%BA%E8%84%B8%E7%A4%BA%E4%BE%8B.png"><meta property="og:image" content="http://cdn.wangng.com/Deeplearning/%E8%83%B6%E5%9B%8A%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/%E4%BA%BA%E5%83%8F%E7%A4%BA%E4%BE%8B.png"><meta property="og:image" content="http://cdn.wangng.com/Deeplearning/%E8%83%B6%E5%9B%8A%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/%E8%87%AA%E7%94%B1%E5%A5%B3%E7%A5%9E%E5%83%8F.png"><meta property="og:image" content="http://cdn.wangng.com/Deeplearning/%E8%83%B6%E5%9B%8A%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/%E8%83%B6%E5%9B%8A%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C.png"><meta property="og:image" content="http://cdn.wangng.com/Deeplearning/%E8%83%B6%E5%9B%8A%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/%E5%9B%BE7.png"><meta property="og:image" content="http://cdn.wangng.com/Deeplearning/%E8%83%B6%E5%9B%8A%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/%E5%9B%BE8.png"><meta property="og:image" content="http://cdn.wangng.com/Deeplearning/%E8%83%B6%E5%9B%8A%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/%E5%8A%A8%E6%80%81%E8%B7%AF%E7%94%B1.png"><meta property="og:image" content="http://cdn.wangng.com/Deeplearning/%E8%83%B6%E5%9B%8A%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/%E7%A5%9E%E7%BB%8F%E5%85%83%E4%BC%A0%E6%92%AD.png"><meta property="article:published_time" content="2019-08-30T02:35:37.000Z"><meta property="article:modified_time" content="2020-05-01T15:09:06.711Z"><meta property="article:author" content="jackcywang"><meta property="article:tag" content="Deeplearning"><meta property="article:tag" content="Capsnet"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://cdn.wangng.com/Deeplearning/%E8%83%B6%E5%9B%8A%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/%E6%A0%A1%E8%BD%A6%E7%A4%BA%E4%BE%8B.png"><link rel="canonical" href="https://wangng.com/articles/5d654916.html/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>胶囊神经网络 | jackcywang's blog</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?8ce866754ae6c95a7238894d36ad3ab0";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div> <a href="https://github.com/jackcywang" target="_blank" rel="noopener" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#64ceaa;color:#fff;position:absolute;top:0;border:0;right:0" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><div><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">jackcywang's blog</span><span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">梦想与现实只在一念之间</p></div><div class="site-nav-right"><div class="toggle popup-trigger"></div></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-fw fa-home"></i> 首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i> 关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i> 归档</a></li></ul></nav></div></header><div class="reading-progress-bar"></div><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content"><div class="posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://wangng.com/articles/5d654916.html/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.gif"><meta itemprop="name" content="jackcywang"><meta itemprop="description" content="不经一番彻骨寒,怎得梅花扑鼻香"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="jackcywang's blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> 胶囊神经网络</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2019-08-30 10:35:37" itemprop="dateCreated datePublished" datetime="2019-08-30T10:35:37+08:00">2019-08-30</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Deeplearning/" itemprop="url" rel="index"><span itemprop="name">Deeplearning</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Deeplearning/Capsnet/" itemprop="url" rel="index"><span itemprop="name">Capsnet</span></a></span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-comment-o"></i></span> <span class="post-meta-item-text">Valine：</span><a title="valine" href="/articles/5d654916.html/#valine-comments" itemprop="discussionUrl"><span class="post-comments-count valine-comment-count" data-xid="/articles/5d654916.html/" itemprop="commentCount"></span></a></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">本文字数：</span> <span>4.1k</span></span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i></span> <span class="post-meta-item-text">阅读时长 &asymp;</span> <span>4 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><h3 id="CNN的缺陷"><a href="#CNN的缺陷" class="headerlink" title="CNN的缺陷"></a>CNN的缺陷</h3><p>&ensp;&ensp;CNN中，每个卷积核就是一个filter，卷积的操作是在图片中与对应位置相乘后求和，其实就是求相关性，filter就是需要匹配的模板，各种filter具有不同的作用，有的对边缘敏感，有的对颜色敏感。每个神经元包含很多个filter，以用来检测特定的feature。如图1所示，如果神经元检测到图片中包含很多黄色块，神经元就会很敏感。</p><a id="more"></a><p><img src="http://cdn.wangng.com/Deeplearning/胶囊神经网络/校车示例.png" alt="图1校车示例"><br><img src="http://cdn.wangng.com/Deeplearning/胶囊神经网络/曲线示例.png" alt="图2曲线示例"><br>&ensp;&ensp;假设这里有一个卷积核（左图），除了曲线轨迹上的值很大，其他的值都是零，所以这个卷积核对旁边这种曲线（右图）就有很高的输出，也就是说对这种曲线有很高的识别，而对其他的曲线类型输出就低。<br>&ensp;&ensp;所以如图像分类中，一旦卷积核检测到了类似于眼睛啊、鼻子啊、嘴巴这种特征；从数学角度上说就，相关卷积核对鼻子、眼睛等卷积出来的值很大，那么与人脸相关的神经元就相当兴奋，最后将图像分类到人脸这一类。所以这就导致了一个问题。如下图3，，右边那张眼睛、鼻子、嘴巴都有了，当然我们的CNN也相当兴奋的将它归于人脸。<br><img src="http://cdn.wangng.com/Deeplearning/胶囊神经网络/人脸示例.png" alt="图3人脸示例"><br><img src="http://cdn.wangng.com/Deeplearning/胶囊神经网络/人像示例.png" alt="图4人像示例"><br>&ensp;&ensp;上面的图4例所示，当仅仅改变Kim Kardashian的图片方向，预测的准确度就会大幅下降。右边的图片，我们能很容易地看出来一只眼睛和她的嘴巴都放在错误的位置，这不是一个人该有的模样。然而，我们却看到这张图是被预测为是人的可能性是0.9。一个被训练地很好的CNN模型在这个方法上会有一些问题。除了很容易地被特征被放置在错误位置的图片欺骗，对于不同方向的图片，CNN模型也很容易辨认不明。</p><h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>&ensp;&ensp;重新审视CNN的工作方式，高层特征是底层特征的加权和，前一层的激活与下一层神经元的权重相乘并相加，接着通过非线性激活函数进行激活，在这一个框架中，高层特征与底层特征的位置关系变得模糊，而CNN解决这一问题的方式是最大池化或卷积层扩大后续卷积核的感受野。<br>&ensp;&ensp;Hinton提出，保留对象部件之间的分层位姿关系对于正确分类和辨识对象来说很重要，胶囊网络结合了对象之间的相对关系，在数值中表示为4维位姿矩阵，当模型有了位姿信息后，它可以很容易的理解它看到的是以前看到的东西，只是改变了视角而已，如下图5所示，人眼可以很容易分辨出是自由女神像，只是角度的不同，但CNN却很难做到，而把位姿信息集合进去的胶囊神经网络，是可以判别出是自由女神像的不同角度。<br><img src="http://cdn.wangng.com/Deeplearning/胶囊神经网络/自由女神像.png" alt="图5自由女神像"></p><p><strong>CNN存在的问题</strong><br>1.CNN要么需要大量图片来训练，要么需要复用训练好的CNN网络来填充当前网络的某些层<br>2.对于元素丰富的图片，CNN不能很好的处理某些模棱两可的边界。<br>3.CNN在池化层，会丢失大量信息。池化层降低了空间分辨率，所以它们的输出对于输入的小变化是不敏感的。</p><h3 id="胶囊神经网络"><a href="#胶囊神经网络" class="headerlink" title="胶囊神经网络"></a>胶囊神经网络</h3><p><img src="http://cdn.wangng.com/Deeplearning/胶囊神经网络/胶囊神经网络.png" alt="图6胶囊神经网络"><br>&ensp;&ensp;所谓胶囊，就是一个向量，它可包含任意个值，每个值代表了当前需要识别的物体（比如图片）的一个特征。结合之前对传统CNN的学习，我们知道，卷积层的每个值，都是上一层某一块区域和卷积核完成卷积操作，即线性加权求和的结果，它只有一个值，所以是标量。而我们的胶囊网络，它的每一个值都是向量，也就是说，这个向量不仅可表示物体的特征、还可以包括物体的方向、状态等等。从上图，我们可以看到，输入是一张手写字的图片。首先对这张图片做了常规的卷积操作，得到ReLU Conv1；然后再对ReLU Conv1做卷积操作，并将其调整成适用于CapsNet的向量神经元层PrimaryCaps。<br>&ensp;&ensp;而第二层(PrimaryCaps)才是真正开始使用Capsul的层，但这层跟它的低一层，也就是上面说的conv layer之间，却并未使用routing算法。这层才是真正为了做routing而准备的。我们先来看下，如果在第一层的输出上做常规的32 channel, 9x9 kernel size和strides 2的CNN，结果是怎么样的呢？事实上我们将得到一个6x6x32的输出，或者说是6x6x1x32的输出（这个1不是随便加的，下面有作用）,如图7<br><img src="http://cdn.wangng.com/Deeplearning/胶囊神经网络/图7.png" alt="图7"><br>&ensp;&ensp;将这个图与原文的图6对比可以看出，原本convolution每次的计算输出是一个scalar value，现在到了PrimaryCaps这里成了一个长度为8的vector，也就是从6x6x1x32到了6x6x8x32（这里1就起作用了，从1到8的转变，也就是从标量向矢量的变化）。这是怎么做到的呢？按照我的理解，其实可以看作第二层在第一层的输出上用8个不同的conv2d层做了共8次32channel,9x9 kernel size和strides 2的卷积（每个conv2d分别一次），如下图(2)所示，每次都得到一个6x6x1x32的输出，共8个，再把这些输出在6x6x1x32的第三个纬度上concatenate,就得到了第二层最终的输出：6x6x8x32大小的高维矩阵，如图8所示。<br><img src="http://cdn.wangng.com/Deeplearning/胶囊神经网络/图8.png" alt="图8"><br>PrimaryCaps到DigitCaps层的传播也就是CapsNet和以往CNN操作的最大区别，本文的提出的算法：动态路由算法，也就运用在这一过程之中，这两层的连接类似于全连接，将32x6x6个维度为8(维度为1的神经元变成维度为8)的胶囊神经元与10个维度为16(维度为1的神经元变成维度为16)的胶囊神经元进行全连接。</p><h4 id="动态路由算法"><a href="#动态路由算法" class="headerlink" title="动态路由算法"></a>动态路由算法</h4><p><img src="http://cdn.wangng.com/Deeplearning/胶囊神经网络/动态路由.png" alt="图9"></p><p><strong>网络连接方式</strong><br>胶囊网络(PrimaryCaps到DigitCaps)和全连接网络的连接方式一模一样。前一层每一个胶囊神经单元都会和后一层每一个胶囊神经单元相连。<br><strong>网络输入</strong><br>全连接神经网络的输入即线性加权求和，胶囊网络很类似，但是它在线性求和阶段上多加了一个耦合系数C。胶囊网络的输入S由下面公式得到：</p><p>$S<em>{j}=\sum</em>{i} c<em>{i j} \hat{u}</em>{j / i}$ （1）</p><p>$\hat{u}<em>{j | i}=W</em>{i j} u_{i}$ （2）</p><p>其中$u$是上一层胶囊网络的输出，$W$是每个输出要乘的权值，可以看作上一层每一个胶囊神经元以不同强弱的连接输出到后一层的某一个神经元。C根据下面公式计算：</p><p>$c<em>{i j}=\frac{\exp \left(b</em>{i j}\right)}{\sum<em>{k} \exp \left(b</em>{i k}\right)}$ (3)</p><p>C叫做耦合系数。为了求C我们必须先求b，b根据下面公式计算：</p><p>$b<em>{i j} \leftarrow b</em>{i j}+\hat{u}<em>{j | i} \cdot v</em>{j}$ (4)</p><p>b初始值为0。故在前向传播求S的过程中，我们把W设计成随机值，b初始化为0可以得到C，u就是上一层胶囊网络的输出，有了三这个值，我们就可以得到下一层的S。<br><strong>激活函数</strong><br>在全连接神经网络中，我们选择的激活函数通常为：sigmoid, tanh等。但在胶囊网络中，Hinton构造了新的激活函数Squashing，故输出V的计算如下图所示:</p><p>$\mathrm{v}<em>{j}=\frac{\left|s</em>{j}\right|^{2}}{1+\left|s<em>{j}\right|^{2}} \frac{s</em>{j}}{\left|s_{j}\right|}$ (5)</p><p>该激活函数前一部分是输入输入向量S的缩放尺度，后一部分是S的单位向量。该激活函数既保留了输入输入向量的方向，又将输入向量的模压缩到[0, 1]之间。<br>除了耦合系数C是通过动态路由更新的，整个网络其他的卷积参数和Capusle内的W都需要根据损失函数进行更新。在原论文中，作者采用SVM中常用的Margin Loss，表达式如下:</p><p>$L<em>{c}=T</em>{c} \max \left(0, m^{+}-\left|\mathbf{v}<em>{c}\right|\right)^{2}+\lambda\left(1-T</em>{c}\right) \max \left(0,\left|<em>{\mathbf{V}</em>{c}}\right|-m^{-}\right)^{2}$ (6)</p><p>$T_{c}$的值为0或1,$m^{+}=0.9$为上margin,惩罚假阴性（没有预测到存在的分类的情况), $m^{-}=0.1$为下margin，惩罚假阳性（预测到不存在的分类的情况），分别对应于用于增加类内相似度和减小类间相似度的正和负边距，$\lambda$是一个常数，为0.5,第一个式子Tc意味着gt中有的类，你要预测出来，没有预测出来要惩罚，第一个式子意味着gt中没有的类，你不能预测出来，预测出来了要惩罚.</p><h3 id="胶囊网络总结"><a href="#胶囊网络总结" class="headerlink" title="胶囊网络总结"></a>胶囊网络总结</h3><p>&ensp;&ensp;胶囊网络也是一种神经网络，与普通神经网络的区别是胶囊网络的神经元是一个向量（一组值）而不是一个标量（单个值），其神经元叫做向量神经元（vector neuron）。向量神经元中的每个值表示某一个属性，如姿态（位置、大小、方向），形变，速度，颜色，纹理结构等。<br>&ensp;&ensp;向量神经元还有一个特殊的属性，其值由向量长度来表示，即神经元所表示的实例存在的概率。说明向量长度在[0,1]区间内。这样，各个属性构成了向量神经元的方向，而实例存在的概率构成向量神经元的长度。<br>&ensp;&ensp;下图是标量神经元（普通神经元）与向量神经元的前向传播过程<br><img src="http://cdn.wangng.com/Deeplearning/胶囊神经网络/神经元传播.png" alt="图10神经元传播"></p><ul><li>标量神经元前向传播过程：<br>1.将输入标量 x 乘上权重 w<br>2.对加权的输入标量求和成标量 a<br>3.用非线性函数将标量 a 转化成标量 h</li><li>向量神经元前向传播过程：<br>1.将输入向量 u 与矩阵 W 相乘得到新的输入向量 U<br>2.将输入向量 U 乘上权重 c<br>3.对加权的输入向量求和成向量 s<br>4.用非线性函数将向量 s 转化成向量 v</li><li><strong>优点</strong></li></ul><ol><li>处理较小的数据集时，效果非常好（例如MNIST）</li><li>更易于解释鲁棒图像</li><li>保留所有信息（pose、texture、location等）</li></ol><ul><li><strong>缺点</strong></li></ul><ol><li>处理较大的数据集时，效果较差（例如CIFAR10)</li><li>路由协议算法需要更多计算时间（在全连接中针对向量计算）</li></ol><h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p><a href="https://blog.csdn.net/godwriter/article/details/79216404" target="_blank" rel="noopener">CapsNet——胶囊网络原理</a><br><a href="https://www.zhihu.com/question/67287444/answer/251460831" target="_blank" rel="noopener">云梦居客</a><br>[搜狐]<a href="https://www.sohu.com/a/226611009_633698" target="_blank" rel="noopener">https://www.sohu.com/a/226611009_633698</a><br><a href="https://blog.csdn.net/luoxuexiong/article/details/88601440" target="_blank" rel="noopener">胶囊网络（CapsulesNet）理解</a></p></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> jackcywang</li><li class="post-copyright-link"> <strong>本文链接：</strong> <a href="https://wangng.com/articles/5d654916.html/" title="胶囊神经网络">https://wangng.com/articles/5d654916.html/</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/Deeplearning/" rel="tag"><i class="fa fa-tag"></i> Deeplearning</a><a href="/tags/Capsnet/" rel="tag"><i class="fa fa-tag"></i> Capsnet</a></div><div class="post-nav"><div class="post-nav-item"><a href="/articles/34f2d837.html/" rel="prev" title="分类网络之ResNext解读"><i class="fa fa-chevron-left"></i> 分类网络之ResNext解读</a></div><div class="post-nav-item"> <a href="/articles/57a91720.html/" rel="next" title="轻量模型之MobileNetV3">轻量模型之MobileNetV3<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div><div class="tabs tabs-comment"><ul class="nav-tabs"><li class="tab"><a href="#comment-gitalk">gitalk</a></li><li class="tab"><a href="#comment-valine">valine</a></li></ul><div class="tab-content"><div class="tab-pane gitalk" id="comment-gitalk"><div class="comments" id="gitalk-container"></div></div><div class="tab-pane valine" id="comment-valine"><div class="comments" id="valine-comments"></div></div></div></div><script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#CNN的缺陷"><span class="nav-number">1.</span> <span class="nav-text">CNN的缺陷</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#分析"><span class="nav-number">2.</span> <span class="nav-text">分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#胶囊神经网络"><span class="nav-number">3.</span> <span class="nav-text">胶囊神经网络</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#动态路由算法"><span class="nav-number">3.1.</span> <span class="nav-text">动态路由算法</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#胶囊网络总结"><span class="nav-number">4.</span> <span class="nav-text">胶囊网络总结</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#参考"><span class="nav-number">5.</span> <span class="nav-text">参考</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><p class="site-author-name" itemprop="name">jackcywang</p><div class="site-description" itemprop="description">不经一番彻骨寒,怎得梅花扑鼻香</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">66</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">14</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">65</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/jackcywang" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;jackcywang" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:yourname@gmail.com" title="E-Mail → mailto:yourname@gmail.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span><span class="links-of-author-item"><a href="https://blog.csdn.net/weixin_42631693" title="CSDN → https:&#x2F;&#x2F;blog.csdn.net&#x2F;weixin_42631693" rel="noopener" target="_blank"><i class="fa fa-fw fa-CSDN"></i> CSDN</a></span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/hao-han-zhong-de-yipian-xie" title="知乎 → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;hao-han-zhong-de-yipian-xie" rel="noopener" target="_blank"><i class="fa fa-fw fa-知乎"></i> 知乎</a></span></div></div><div class="back-to-top motion-element"><i class="fa fa-arrow-up"></i> <span>0%</span></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; 2019 – <span itemprop="copyrightYear">2020</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">jackcywang</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-area-chart"></i></span> <span title="站点总字数">261k</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-coffee"></i></span> <span title="站点阅读时长">3:57</span></div><span id="sitetime"></span><script language="javascript">function siteTime(){window.setTimeout("siteTime()",1e3);var e=36e5,t=24*e,o=new Date,i=o.getFullYear(),n=o.getMonth()+1,a=o.getDate(),r=o.getHours(),s=o.getMinutes(),g=o.getSeconds(),l=Date.UTC(2020,1,1,15,0,0),m=Date.UTC(i,n,a,r,s,g)-l,M=Math.floor(m/t),T=Math.floor((m-M*t)/e),u=Math.floor((m-M*t-T*e)/6e4),f=Math.floor((m-M*t-T*e-6e4*u)/1e3);document.getElementById("sitetime").innerHTML=" 在此已等候"+M+" 天 "+T+" 小时 "+u+" 分钟 "+f+" 秒"}siteTime()</script><div> <a href="http://www.miitbeian.gov.cn/" rel="noopener" target="_blank">陕ICP备19023518号-1</a> <span class="post-meta-divider">|</span> <span style="padding-left:25px;background:url(/images/beian.png) no-repeat left center" rel="nofollow"><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=61019002001038" rel="noopener" target="_blank">陕公网安备61019002001038号</a></span></div></div></footer></div><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script><script async src="/js/cursor/fireworks.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/moment.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment-precise-range-plugin@1.3.0/moment-precise-range.min.js"></script><script>
    function timer() {
      var ages = moment.preciseDiff(moment(),moment(20191220,"YYYYMMDD"));
      //去除时分秒信息
      ages = ages.replace(/\s?\d{0,2}\s+hours?/, "");
      ages = ages.replace(/\s?\d{0,2}\s+minutes?/, "");
      ages = ages.replace(/\s?\d{0,2}\s+seconds?/, "");
      //将年月日转换为中文
      ages = ages.replace(/years?/, "年");
      ages = ages.replace(/months?/, "月");
      ages = ages.replace(/days?/, "天");
      ages = ages.replace(/\d+/g, '<span style="color:#1890ff">$&</span>');
      span.innerHTML = `footer.age ${ages}`;
    }
    var span = document.createElement("span");
    //插入到agesicon之后
    var agesicon = document.querySelector(".footer-ages-icon");
    document.querySelector(".copyright").insertBefore(span, agesicon.nextSibling);
    timer();
  </script><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css"><script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : '500094376d9d18a3ed06',
      clientSecret: '71db1de3f4d19d73479a0ad6887d90081e8b7ca1',
      repo        : 'MyGitalk',
      owner       : 'jackcywang',
      admin       : ['jackcywang'],
      id          : '17afe556aea502b96751fe357364c234',
        language: '',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script><script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'qHl8YMnB0b5OHNGx0AO0fjIE-gzGzoHsz',
      appKey     : 'wN3c6hhMnkEwVWOSLF0xQ3In',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : 'zh-cn' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script><script src="//lib.baomitu.com/jquery/3.3.1/jquery.min.js"></script><script src="https://player.lmih.cn/player/js/player.js" id="myhk" key="158704924834" m="1"></script></body></html>